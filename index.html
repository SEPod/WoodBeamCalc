<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wood Beams ‚Äì World's Slowest Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #f5f5f7;
      --card-bg: #ffffff;
      --border: #d0d0d5;
      --accent: #1f6feb;
      --accent-soft: rgba(31, 111, 235, 0.08);
      --text-main: #111827;
      --text-muted: #4b5563;
      --danger: #b91c1c;
      --radius-lg: 18px;
      --radius-md: 10px;
      --shadow-soft: 0 16px 40px rgba(15, 23, 42, 0.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #dbeafe 0, #f5f5f7 52%);
      color: var(--text-main);
    }

    .app {
      max-width: 1080px;
      margin: 0 auto;
      padding: 2.2rem 1rem 3rem;
    }

    header {
      margin-bottom: 1.75rem;
    }

    header h1 {
      margin: 0 0 0.2rem;
      font-size: 2.1rem;
      letter-spacing: 0.02em;
    }

    header p {
      margin: 0.1rem 0;
      color: var(--text-muted);
      font-size: 0.96rem;
    }

    .tagline {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      margin-top: 0.5rem;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      background: #fef9c3;
      color: #854d0e;
      font-size: 0.8rem;
      font-weight: 500;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      padding: 1.5rem 1.6rem 1.8rem;
      margin-bottom: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.45);
    }

    .card h2 {
      margin: 0 0 0.5rem;
      font-size: 1.25rem;
    }

    .sub {
      margin: 0 0 0.7rem;
      color: var(--text-muted);
      font-size: 0.86rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 0.6rem 1rem;
      margin-top: 0.25rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .field label {
      margin-bottom: 0.16rem;
      color: var(--text-muted);
    }

    .field input,
    .field select {
      padding: 0.35rem 0.5rem;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      font-size: 0.86rem;
    }

    .field input:focus,
    .field select:focus {
      outline: 2px solid var(--accent);
      outline-offset: 1px;
      background: #ffffff;
    }

    .inline-radio {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      font-size: 0.84rem;
      margin-top: 0.25rem;
      color: var(--text-muted);
    }

    .inline-radio label {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      cursor: pointer;
    }

    .quiz-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 0.6rem 0.9rem;
      margin-top: 0.45rem;
    }

    .quiz-pill {
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      padding: 0.45rem 0.7rem;
      display: flex;
      align-items: flex-start;
      gap: 0.4rem;
      background: #f9fafb;
      font-size: 0.83rem;
    }

    .quiz-pill input {
      margin-top: 0.3rem;
    }

    .quiz-pill code {
      font-size: 0.78rem;
      white-space: pre-wrap;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.7rem;
      margin-top: 1rem;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 0.6rem 1.25rem;
      font-size: 0.92rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      white-space: nowrap;
    }

    button.primary {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 12px 24px rgba(37, 99, 235, 0.45);
    }

    button.secondary {
      background: #e5e7eb;
      color: #111827;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    .status {
      font-size: 0.82rem;
      margin-top: 0.4rem;
      min-height: 1.1em;
    }

    .status.error {
      color: var(--danger);
    }

    .status.ok {
      color: #15803d;
    }

    pre {
      margin: 0;
      padding: 0.85rem 0.95rem;
      border-radius: var(--radius-md);
      background: #020617;
      color: #e5e7eb;
      font-family: "SF Mono", ui-monospace, Menlo, Consolas, monospace;
      font-size: 0.82rem;
      line-height: 1.5;
      overflow-x: auto;
      border: 1px solid #111827;
    }

    footer {
      margin-top: 1.4rem;
      font-size: 0.78rem;
      color: var(--text-muted);
      text-align: right;
    }

    @media (max-width: 680px) {
      .app { padding-inline: 0.85rem; }
      header h1 { font-size: 1.7rem; }
      button.primary,
      button.secondary {
        flex: 1 1 auto;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Wood Beams</h1>
      <p>Single-span trainer for simple beams with a partial uniform load and a point load.</p>
      <div class="tagline">
        üå≤ World's slowest calculator &amp; fastest learning tool
      </div>
    </header>

    <!-- 1. Beam & design method -->
    <section class="card">
      <h2>1. Beam info &amp; design method</h2>
      <p class="sub">
        Start with a simple simply-supported beam. Units are up to you; just be consistent
        (e.g., ft &amp; kips, mm &amp; kN).
      </p>

      <div class="grid">
        <div class="field">
          <label for="spanL">Span length, L</label>
          <input id="spanL" type="number" step="0.01" placeholder="e.g. 18 (ft)" />
        </div>
        <div class="field">
          <label for="species">Species / product</label>
          <input id="species" type="text" placeholder="e.g. DF-L No. 2, 3.5x11.875 LVL" />
        </div>
        <div class="field">
          <label>Design method</label>
          <div class="inline-radio">
            <label><input type="radio" name="designMethod" value="ASD" checked /> ASD</label>
            <label><input type="radio" name="designMethod" value="LRFD" /> LRFD</label>
          </div>
        </div>
      </div>
    </section>

    <!-- 2. Loading -->
    <section class="card">
      <h2>2. Loading ‚Äì partial uniform + point load</h2>
      <p class="sub">
        Define loads along the span. The trainer uses statics with Macaulay brackets for the general case:
        a uniform load between <em>a</em> and <em>b</em> plus a point load at <em>x<sub>P</sub></em>.
      </p>

      <div class="grid">
        <div class="field">
          <label for="w">Uniform load, w</label>
          <input id="w" type="number" step="0.01" placeholder="e.g. 0.8 (kip/ft)" />
        </div>
        <div class="field">
          <label for="wStart">Uniform load start, a</label>
          <input id="wStart" type="number" step="0.01" placeholder="e.g. 0 (ft)" />
        </div>
        <div class="field">
          <label for="wEnd">Uniform load end, b</label>
          <input id="wEnd" type="number" step="0.01" placeholder="e.g. 18 (ft)" />
        </div>
        <div class="field">
          <label for="P">Point load, P</label>
          <input id="P" type="number" step="0.01" placeholder="e.g. 4 (kips)" />
        </div>
        <div class="field">
          <label for="Px">Point load position, x<sub>P</sub></label>
          <input id="Px" type="number" step="0.01" placeholder="e.g. 9 (ft)" />
        </div>
      </div>

      <p class="sub" style="margin-top:0.8rem;">
        Tip: leave <code>w</code> or <code>P</code> blank (or zero) if you want only one type of load.
      </p>
    </section>

    <!-- 3. Quiz ‚Äì shear equation -->
    <section class="card">
      <h2>3. Shear equation quiz</h2>
      <p class="sub">
        Pick the correct expression for the shear diagram using Macaulay bracket notation
        ‚ü®x ‚àí c‚ü© = max(0, x ‚àí c) and the step function H(x ‚àí c).
      </p>

      <div class="quiz-options">
        <label class="quiz-pill">
          <input type="radio" name="shearFormula" value="correct" />
          <div>
            <strong>Option A</strong>
            <div><code>
V(x) = R_A
       ‚àí w‚ü®x ‚àí a‚ü©
       + w‚ü®x ‚àí b‚ü©
       ‚àí P¬∑H(x ‚àí x_P)
            </code></div>
          </div>
        </label>

        <label class="quiz-pill">
          <input type="radio" name="shearFormula" value="wrong" />
          <div>
            <strong>Option B</strong>
            <div><code>
V(x) = R_A
       ‚àí w‚ü®x ‚àí a‚ü©
       ‚àí P
            </code></div>
            <div style="margin-top:0.2rem; color:var(--text-muted);">
              (Hint: what happens after the load patch ends or before the point load?)
            </div>
          </div>
        </label>
      </div>
    </section>

    <!-- 4. Quiz ‚Äì moment equation -->
    <section class="card">
      <h2>4. Moment equation quiz</h2>
      <p class="sub">
        Now choose the bending moment expression built from the same loads. Again, ‚ü®x ‚àí c‚ü© = max(0, x ‚àí c).
      </p>

      <div class="quiz-options">
        <label class="quiz-pill">
          <input type="radio" name="momentFormula" value="correct" />
          <div>
            <strong>Option A</strong>
            <div><code>
M(x) = R_A¬∑x
       ‚àí ¬Ω w‚ü®x ‚àí a‚ü©¬≤
       + ¬Ω w‚ü®x ‚àí b‚ü©¬≤
       ‚àí P‚ü®x ‚àí x_P‚ü©
            </code></div>
          </div>
        </label>

        <label class="quiz-pill">
          <input type="radio" name="momentFormula" value="wrong" />
          <div>
            <strong>Option B</strong>
            <div><code>
M(x) = R_A¬∑x
       ‚àí w‚ü®x ‚àí a‚ü©
       ‚àí P‚ü®x ‚àí x_P‚ü©
            </code></div>
            <div style="margin-top:0.2rem; color:var(--text-muted);">
              (Suspiciously missing something with a square‚Ä¶)
            </div>
          </div>
        </label>
      </div>

      <div class="button-row">
        <button class="primary" type="button" id="btnRun">‚ñ∂ Run beam check</button>
        <button class="secondary" type="button" id="btnClear">Reset inputs</button>
      </div>
      <div id="status" class="status"></div>
    </section>

    <!-- 5. Results -->
    <section class="card">
      <h2>5. Results &amp; formulas used</h2>
      <p class="sub">
        Once the quiz answers are correct, the calculator will report reactions and
        approximate maximum shear &amp; moment along the span, using the chosen loading.
      </p>
      <pre id="results">(No results yet ‚Äì fill in the beam, pass the quizzes, then hit ‚ÄúRun beam check.‚Äù)</pre>
    </section>

    <footer>
      Wood beam trainer ‚Äì educational only, not a design program. Verify against NDS, ASCE 7, and project requirements.
    </footer>
  </div>

  <script>
    function valNum(id) {
      const raw = document.getElementById(id).value;
      if (raw === "") return null;
      const v = parseFloat(raw);
      return isNaN(v) ? null : v;
    }

    function ramp(x) {
      return x > 0 ? x : 0;
    }

    function runBeamCheck() {
      const statusEl = document.getElementById("status");
      const resultsEl = document.getElementById("results");
      statusEl.textContent = "";
      statusEl.className = "status";

      const L = valNum("spanL");
      if (!L || L <= 0) {
        statusEl.textContent = "I need a positive span length L before we start doing statics.";
        statusEl.classList.add("error");
        return;
      }

      let w = valNum("w") || 0;
      let a = valNum("wStart");
      let b = valNum("wEnd");
      let P = valNum("P") || 0;
      let xP = valNum("Px");

      // Loading sanity checks
      if (w !== 0) {
        if (a === null || b === null) {
          statusEl.textContent = "For the uniform load, please provide both a start (a) and end (b).";
          statusEl.classList.add("error");
          return;
        }
        if (a < 0 || b < 0 || a > L || b > L || b < a) {
          statusEl.textContent = "Uniform load must satisfy 0 ‚â§ a ‚â§ b ‚â§ L. Right now it does not.";
          statusEl.classList.add("error");
          return;
        }
      } else {
        // If w is zero, ignore a/b
        a = 0;
        b = 0;
      }

      if (P !== 0) {
        if (xP === null) {
          statusEl.textContent = "You gave me a point load P but no position x_P.";
          statusEl.classList.add("error");
          return;
        }
        if (xP < 0 || xP > L) {
          statusEl.textContent = "Point load position must be between 0 and L.";
          statusEl.classList.add("error");
          return;
        }
      } else {
        xP = 0;
      }

      // Quiz checks
      const shearChoice = document.querySelector('input[name="shearFormula"]:checked');
      const momentChoice = document.querySelector('input[name="momentFormula"]:checked');

      if (!shearChoice || !momentChoice) {
        statusEl.textContent = "Pick a shear equation AND a moment equation before we run the beam.";
        statusEl.classList.add("error");
        return;
      }

      if (shearChoice.value !== "correct") {
        statusEl.textContent =
          "My internal shear goblins are offended. That shear expression leaks equilibrium. Try the other option.";
        statusEl.classList.add("error");
        return;
      }

      if (momentChoice.value !== "correct") {
        statusEl.textContent =
          "The bending gnomes protest: that moment formula is missing a square. Give Option A a shot.";
        statusEl.classList.add("error");
        return;
      }

      // All good ‚Äì time to actually calculate.
      // Treat partial uniform as equivalent distributed load with Macaulay brackets.
      const W = w * Math.max(0, b - a);               // total uniform load
      const x_c = W !== 0 ? 0.5 * (a + b) : 0.0;      // centroid of patch

      // Reactions from equilibrium:
      //  R_B = (W x_c + P xP) / L
      //  R_A = W + P - R_B
      let RB = 0;
      let RA = 0;
      if (W !== 0 || P !== 0) {
        RB = (W * x_c + P * xP) / L;
        RA = W + P - RB;
      }

      // Shear and moment via Macaulay expressions
      function Vx(x) {
        // V(x) = R_A ‚àí w‚ü®x ‚àí a‚ü© + w‚ü®x ‚àí b‚ü© ‚àí P¬∑H(x ‚àí xP)
        let v = RA;
        if (w !== 0) {
          v -= w * ramp(x - a);
          v += w * ramp(x - b);
        }
        if (P !== 0 && x >= xP) {
          v -= P;
        }
        return v;
      }

      function Mx(x) {
        // M(x) = R_A x ‚àí ¬Ω w‚ü®x ‚àí a‚ü©¬≤ + ¬Ω w‚ü®x ‚àí b‚ü©¬≤ ‚àí P‚ü®x ‚àí xP‚ü©
        let m = RA * x;
        if (w !== 0) {
          m -= 0.5 * w * Math.pow(ramp(x - a), 2);
          m += 0.5 * w * Math.pow(ramp(x - b), 2);
        }
        if (P !== 0) {
          m -= P * ramp(x - xP);
        }
        return m;
      }

      // Sample along the span to find approximate max |V| and |M|
      let Vmax = 0, xVmax = 0;
      let Mmax = 0, xMmax = 0;
      const n = 600;
      const dx = L / n;

      for (let i = 0; i <= n; i++) {
        const x = dx * i;
        const V = Vx(x);
        const M = Mx(x);
        if (Math.abs(V) > Math.abs(Vmax)) {
          Vmax = V;
          xVmax = x;
        }
        if (Math.abs(M) > Math.abs(Mmax)) {
          Mmax = M;
          xMmax = x;
        }
      }

      function fmt(x, digits) {
        if (!isFinite(x)) return "N/A";
        return x.toFixed(digits);
      }

      const method = (document.querySelector('input[name="designMethod"]:checked') || {}).value || "ASD";
      const species = (document.getElementById("species").value || "").trim();

      let out = [];

      out.push("WOOD BEAM SUMMARY");
      out.push("-----------------");
      out.push(`Span: L = ${fmt(L, 3)} (length units)`);
      if (species) out.push(`Member: ${species}`);
      out.push(`Design method: ${method}`);
      out.push("");

      out.push("Loading:");
      if (W !== 0) {
        out.push(`  Uniform load: w = ${fmt(w, 3)} (force/length) from a = ${fmt(a, 3)} to b = ${fmt(b, 3)}`);
        out.push(`    Total W = w (b - a) = ${fmt(W, 3)} at centroid x_c = (a + b)/2 = ${fmt(x_c, 3)}`);
      } else {
        out.push("  Uniform load: none");
      }
      if (P !== 0) {
        out.push(`  Point load: P = ${fmt(P, 3)} at x_P = ${fmt(xP, 3)}`);
      } else {
        out.push("  Point load: none");
      }
      out.push("");

      out.push("Reactions from equilibrium:");
      out.push("  Œ£M_A = 0 ‚áí R_B L = W x_c + P x_P");
      out.push(`  R_B = (W x_c + P x_P) / L = ${fmt(RB, 3)}`);
      out.push(`  R_A = W + P ‚àí R_B = ${fmt(RA, 3)}`);
      out.push("");

      out.push("Selected shear expression (you picked the correct one):");
      out.push("  V(x) = R_A ‚àí w‚ü®x ‚àí a‚ü© + w‚ü®x ‚àí b‚ü© ‚àí P¬∑H(x ‚àí x_P)");
      out.push("");

      out.push("Selected moment expression:");
      out.push("  M(x) = R_A x ‚àí (1/2) w‚ü®x ‚àí a‚ü©¬≤ + (1/2) w‚ü®x ‚àí b‚ü©¬≤ ‚àí P‚ü®x ‚àí x_P‚ü©");
      out.push("");

      out.push("Approximate extrema along 0 ‚â§ x ‚â§ L:");
      out.push(`  Max |V(x)| ‚âà ${fmt(Vmax, 3)} (force units) at x ‚âà ${fmt(xVmax, 3)}`);
      out.push(`  Max |M(x)| ‚âà ${fmt(Mmax, 3)} (force¬∑length units) at x ‚âà ${fmt(xMmax, 3)}`);
      out.push("");
      out.push("Use these envelopes with NDS section properties (S, Z, I) and adjustment factors to check fb, fv, and deflection in your own calc package.");

      resultsEl.textContent = out.join("\n");
      statusEl.textContent = "Statics complete. Beam goblins appeased ‚úÖ";
      statusEl.classList.add("ok");
    }

    function clearAll() {
      const ids = ["spanL","species","w","wStart","wEnd","P","Px"];
      ids.forEach(id => { const el = document.getElementById(id); if (el) el.value = ""; });

      document.querySelectorAll('input[name="shearFormula"]').forEach(r => r.checked = false);
      document.querySelectorAll('input[name="momentFormula"]').forEach(r => r.checked = false);

      const statusEl = document.getElementById("status");
      statusEl.textContent = "";
      statusEl.className = "status";

      const resultsEl = document.getElementById("results");
      resultsEl.textContent = "(No results yet ‚Äì fill in the beam, pass the quizzes, then hit ‚ÄúRun beam check.‚Äù)";
    }

    document.getElementById("btnRun").addEventListener("click", runBeamCheck);
    document.getElementById("btnClear").addEventListener("click", clearAll);
  </script>
</body>
</html>
